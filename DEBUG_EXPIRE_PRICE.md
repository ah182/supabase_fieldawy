# ๐ ุชุตุญูุญ: ุฅุดุนุงุฑ ุชุญุฏูุซ ุณุนุฑ ููุชุฌ ูุงุฑุจ ุงูุชูุงุก

## โ ุงููุดููุฉ:

ูุธูุฑ:
```
๐ฐ ุชู ุชุญุฏูุซ ุณุนุฑ ููุชุฌ
COLIPRIM Inj.
```

ุจุฏูุงู ูู:
```
๐ฐโ๏ธ ุชุญุฏูุซ ุณุนุฑ ููุชุฌ ุนูู ูุดู ุงูุชูุงุก ุตูุงุญูุชู
```

---

## ๐ ุงููุญุต ุงููุทููุจ:

### 1๏ธโฃ ุงูุญุต Render Logs:

**ูู Render Dashboard:**
1. ุงุฐูุจ ุฅูู **Logs** tab
2. ุงุจุญุซ ุนู ุขุฎุฑ webhook ุชู ุงุณุชูุจุงูู
3. ุงูุณุฎ ููุตู ูุฐู ุงูุณุทูุฑ:

```
๐ฉ ุชููู webhook ูู Supabase
   Operation: UPDATE
   Table: distributor_products
   Record: ...
   Product Name: ...
   Tab Name: ...  โ ูุฐุง ุงูุณุทุฑ ููู ุฌุฏุงู!
โ ุชู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ!
   Title: ...
```

**ุฃุฑุณู ูู ูููุฉ `Tab Name`!**

---

### 2๏ธโฃ ุงูุญุต ุงูููุชุฌ ูู Supabase:

```sql
-- ุงูุญุต ุชุงุฑูุฎ ุงูุชูุงุก ุงูููุชุฌ
SELECT 
  id,
  product_id,
  price,
  expiration_date,
  CASE 
    WHEN expiration_date IS NULL THEN 'ูุง ููุฌุฏ ุชุงุฑูุฎ ุงูุชูุงุก'
    WHEN expiration_date <= NOW() THEN 'ููุชูู ุจุงููุนู'
    WHEN expiration_date > NOW() + INTERVAL '60 days' THEN 'ุฃูุซุฑ ูู 60 ููู'
    ELSE 'ูุงุฑุจ ุนูู ุงูุงูุชูุงุก'
  END as status,
  EXTRACT(DAY FROM (expiration_date - NOW())) as days_left
FROM distributor_products
WHERE id = 'id_of_product_you_updated';  -- ุถุน ID ุงูููุชุฌ ุงูุฐู ุญุฏุซุชู
```

**ุฃุฑุณู ูู ุงููุชูุฌุฉ!**

---

## ๐ฏ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:

### ุงูุณุจุจ 1: ุงูููุชุฌ ููุณ ูุงุฑุจ ุงูุชูุงุก

**ุฅุฐุง ูุงู `expiration_date`:**
- โ `NULL` (ูุง ููุฌุฏ ุชุงุฑูุฎ) โ ูู ููุนุชุจุฑ ูุงุฑุจ ุงูุชูุงุก
- โ ุฃูุซุฑ ูู 60 ููู โ ูู ููุนุชุจุฑ ูุงุฑุจ ุงูุชูุงุก
- โ ููุชูู ุจุงููุนู (ุฃูู ูู NOW) โ ูู ููุนุชุจุฑ ูุงุฑุจ ุงูุชูุงุก
- โ ุจูู 1-60 ููู โ ููุนุชุจุฑ ูุงุฑุจ ุงูุชูุงุก

---

### ุงูุณุจุจ 2: ุงูููุฏ ูู ููุญุฏุซ ุนูู Render

**ููุชุญูู:**

ูู Render Logsุ ุงุจุญุซ ุนู:
```
==> Deploying...
==> Your service is live ๐
```

**ูุดุงูุฏ ุงูุชูููุช** - ูุฌุจ ุฃู ูููู ุจุนุฏ ุขุฎุฑ push ุนูู GitHub.

---

### ุงูุณุจุจ 3: Webhook payload ูุง ูุญุชูู ุนูู `old_record`

**ููุชุญูู:**

ูู Render Logsุ ุงุจุญุซ ุนู:
```
Record: {"id":"...","price":...,"expiration_date":"..."}
```

**ูุฌุจ ุฃู ูุญุชูู ุนูู:**
- โ `expiration_date`
- โ ุชุงุฑูุฎ ุงูุงูุชูุงุก ุฃูู ูู 60 ููู

---

## ๐งช ุงุฎุชุจุงุฑ ุฏููู:

### Test 1: ุฃุถู ููุชุฌ ุฌุฏูุฏ ููุชูู ุฎูุงู 30 ููู

```sql
INSERT INTO distributor_products (
  id,
  distributor_id, 
  product_id,
  package,
  price,
  expiration_date
) VALUES (
  'debug_expire_test',
  (SELECT id FROM users WHERE role = 'distributor' LIMIT 1),
  (SELECT id FROM products WHERE name LIKE '%COLIPRIM%' LIMIT 1),
  'Box',
  100.00,
  NOW() + INTERVAL '30 days'
);
```

**ุงููุชููุน:**
```
โ๏ธ ุชู ุฅุถุงูุฉ ููุชุฌ ูุฑูุจ ุงูุตูุงุญูุฉ
COLIPRIM - [ููุฒุน] - ููุชูู ุฎูุงู 30 ููู
```

---

### Test 2: ุญุฏูุซ ุงูุณุนุฑ

```sql
UPDATE distributor_products
SET price = 150.00
WHERE id = 'debug_expire_test';
```

**ุงููุชููุน:**
```
๐ฐโ๏ธ ุชุญุฏูุซ ุณุนุฑ ููุชุฌ ุนูู ูุดู ุงูุชูุงุก ุตูุงุญูุชู
COLIPRIM - [ููุฒุน]
```

---

### Test 3: ุงูุญุต Render Logs

**ูุฌุจ ุฃู ุชุดุงูุฏ:**
```
๐ฉ ุชููู webhook ูู Supabase
   Operation: UPDATE
   Table: distributor_products
   Product Name: COLIPRIM - [ููุฒุน]
   Tab Name: expire_soon  โ ููู ุฌุฏุงู!
โ ุชู ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ!
   Title: ๐ฐโ๏ธ ุชุญุฏูุซ ุณุนุฑ ููุชุฌ ุนูู ูุดู ุงูุชูุงุก ุตูุงุญูุชู
```

---

## ๐ ุฌุฏูู ุงูุชุดุฎูุต:

| Tab Name ูู Logs | ุงููุชูุฌุฉ | ุงูุณุจุจ |
|------------------|---------|-------|
| `expire_soon` | โ ุตุญูุญ | ุงูููุชุฌ ูุงุฑุจ ุงูุชูุงุก ูุงูููุฏ ูุนูู |
| `price_action` | โ ุฎุทุฃ | ุงูููุชุฌ **ููุณ** ูุงุฑุจ ุงูุชูุงุก |
| `home` | โ ุฎุทุฃ | ูุง ููุฌุฏ `expiration_date` |

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ:

**ุฃุฑุณู ูู:**

1. **Render Logs** (ุงูุณุทูุฑ ูู ๐ฉ ุฅูู โ)
2. **ูุชูุฌุฉ SQL** (ูุญุต expiration_date ููููุชุฌ)
3. **Screenshot** ูู ุงูุฅุดุนุงุฑ ุนูู ุงูุฌูุงุฒ

**ูุณุฃุญุฏุฏ ุงููุดููุฉ ุจุงูุถุจุท! ๐**
