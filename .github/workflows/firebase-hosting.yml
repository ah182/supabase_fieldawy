# GitHub Actions Workflow لـ Auto Deployment على Firebase
# كل مرة تعمل push على main branch، سيتم build و deploy تلقائياً

name: Deploy to Firebase Hosting

on:
  push:
    branches:
      - main
  # يمكنك تفعيل manual trigger أيضاً
  workflow_dispatch:

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    
    steps:
      # 1. جلب الكود
      - name: Checkout Repository
        uses: actions/checkout@v3

      # 2. تثبيت Flutter
      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.0'
          channel: 'stable'

      # 3. تثبيت Dependencies
      - name: Install Dependencies
        run: flutter pub get

      # 4. بناء Flutter Web
      - name: Build Flutter Web
        run: flutter build web --release

      # 5. Deploy إلى Firebase
      - name: Deploy to Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_TOKEN }}'
          channelId: live
          projectId: fieldawy-admin-dashboard # غيّر ده لاسم المشروع بتاعك

# ملاحظات:
# 1. لازم تضيف FIREBASE_TOKEN في GitHub Secrets
# 2. احصل على token بالأمر: firebase login:ci
# 3. أضف token في: Settings → Secrets → Actions → New secret
# 4. اسم السر: FIREBASE_TOKEN
# 5. القيمة: الصق الـ token اللي حصلت عليه
