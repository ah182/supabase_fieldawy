# โ ุชู ุฅุถุงูุฉ ุตูุฑ ุงูููุชุฌุงุช ูู ุชุงุจ Offers

## ๐ ุงูุชุนุฏููุงุช ุงููุทุจูุฉ:

### 1๏ธโฃ ุชุญุฏูุซ ูููุฐุฌ Offer (`offer_model.dart`)
- โ ุฅุถุงูุฉ ุญูู `imageUrl` ุงุฎุชูุงุฑู
- โ ุชุญุฏูุซ `fromJson` ูุงุณุชูุจุงู `image_url`
- โ ุชุญุฏูุซ `toJson` ูุฅุฑุณุงู `image_url`
- โ ุชุญุฏูุซ `copyWith` ูุฏุนู `imageUrl`

### 2๏ธโฃ ุชุญุฏูุซ Repository (`offers_repository.dart`)
- โ ุชุนุฏูู Query ูุฌูุจ ุงูุตูุฑุฉ ูู ุฌุฏูู `products`
- โ ุงุณุชุฎุฏุงู `products!inner(image_url)` ููู JOIN
- โ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงููุฑุฌุนุฉ ูุฅุถุงูุฉ `image_url` ุฅูู ูู offer

### 3๏ธโฃ ุชุญุฏูุซ UI (`product_management_screen.dart`)
- โ ุฅุถุงูุฉ ุนููุฏ "Image" ูู ุจุฏุงูุฉ ุงูุฌุฏูู
- โ ุฅุถุงูุฉ ุฏุงูุฉ `_buildImage` ูุนุฑุถ ุงูุตูุฑุฉ
- โ ุฏุนู ุงูููุฑ ุนูู ุงูุตูุฑุฉ ููุชุญ ุฏูุงููุฌ ุงูุชูุงุตูู
- โ ุฅุถุงูุฉ ุฏุงูุฉ `_showDetailsDialog` ูุนุฑุถ ุชูุงุตูู ุงูู offer
- โ ุนุฑุถ ุงูุตูุฑุฉ ุงููุจูุฑุฉ (250x250) ูู ุงูุฏูุงููุฌ

## ๐ฏ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ ูู Offers Tab:

### ุนุฑุถ ุงูุตูุฑุฉ ูู ุงูุฌุฏูู:
- โ ุตูุฑุฉ ุตุบูุฑุฉ (50x50) ูู ุนููุฏ Image
- โ ุฅุฐุง ูู ุชูู ููุงู ุตูุฑุฉุ ูุธูุฑ ุฃููููุฉ offer
- โ Placeholder ุฃุซูุงุก ุงูุชุญููู
- โ ุฃููููุฉ broken_image ุฅุฐุง ูุดู ุงูุชุญููู

### ุงูููุฑ ุนูู ุงูุตูุฑุฉ:
- โ ุงููุคุดุฑ ูุชุบูุฑ ุฅูู "ูุฏ" ุนูุฏ ุงูุชูุฑูุฑ
- โ ุชูุชุญ ุฏูุงููุฌ ุจุงูุชูุงุตูู ุงููุงููุฉ
- โ ุงูุตูุฑุฉ ุงููุจูุฑุฉ ูู ุงูุฃุนูู (250x250)
- โ ุฌููุน ูุนูููุงุช ุงูู Offer

### ุงูุชูุงุตูู ุงููุนุฑูุถุฉ:
- โ Offer ID
- โ Product ID  
- โ Type (OCR ุฃู Catalog)
- โ Price ุจุงูุฌููู ุงููุตุฑู
- โ Package
- โ Expiration Date
- โ Status (Active ุฃู Expired)
- โ Description (ุฅู ูุฌุฏุช)

## ๐ ููููุฉ ุนูู ุงูู JOIN:

```dart
.select('''
  id,
  product_id,
  is_ocr,
  user_id,
  price,
  expiration_date,
  description,
  package,
  created_at,
  products!inner(image_url)  // ุฌูุจ ุงูุตูุฑุฉ ูู ุฌุฏูู products
''')
```

### ูุนุงูุฌุฉ ุงูุจูุงูุงุช:
```dart
return data.map((json) {
  final offerData = json as Map<String, dynamic>;
  String? imageUrl;
  
  // ุงุณุชุฎุฑุงุฌ image_url ูู ุงูุนูุงูุฉ
  if (offerData['products'] != null) {
    final products = offerData['products'];
    if (products is Map) {
      imageUrl = products['image_url'] as String?;
    }
  }
  
  // ุฅุถุงูุฉ image_url ููู offer
  offerData['image_url'] = imageUrl;
  return Offer.fromJson(offerData);
}).toList();
```

## ๐ ุจููุฉ ุงูุฌุฏูู ุงูุฌุฏูุฏุฉ:

| Image | Product ID | Type | Price | Package | Expiration | Status | Actions |
|-------|-----------|------|-------|---------|------------|--------|---------|
| ๐ผ๏ธ    | ABC123    | OCR  | 50.00 | 10mg    | 2024-12-31 | Active | ๐๏ธ โ๏ธ ๐๏ธ |

## โ ุงูุงุฎุชุจุงุฑุงุช:

```bash
flutter analyze lib/features/offers/domain/offer_model.dart 
flutter analyze lib/features/offers/data/offers_repository.dart 
flutter analyze lib/features/admin_dashboard/presentation/screens/product_management_screen.dart

โ No issues found!
```

## ๐ ุฎุทูุงุช ุงูุชุดุบูู:

### 1. ุชูุธูู ุงูุจูุงุก ุงูุณุงุจู
```bash
flutter clean
flutter pub get
```

### 2. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
```bash
flutter run -d chrome
```

### 3. Hard Refresh ูู ุงููุชุตูุญ
ุงุถุบุท **Ctrl + Shift + R**

### 4. ุงุฎุชุจุงุฑ ุงูููุฒุฉ
1. ุงูุชุญ ุงูููุจ ุฏุงุด ุจูุฑุฏ
2. ุงุฐูุจ ุฅูู ุชุงุจ **Offers**
3. ูุฌุจ ุฃู ุชุฑู:
   - โ ุนููุฏ ุงูุตูุฑ ูู ุจุฏุงูุฉ ุงูุฌุฏูู
   - โ ุตูุฑ ุงูููุชุฌุงุช ุงููุนุฑูุถุฉ
   - โ ูุคุดุฑ ุงููุฏ ุนูุฏ ุงูุชูุฑูุฑ
   - โ ุฏูุงููุฌ ุงูุชูุงุตูู ุนูุฏ ุงูููุฑ

## ๐ ููุงุญุธุงุช ูููุฉ:

### 1. ุงูุนูุงูุฉ ูู Supabase:
- โ ูุฌุจ ุฃู ุชููู ููุงู ุนูุงูุฉ (Foreign Key) ุจูู `offers.product_id` ู `products.id`
- โ ุฅุฐุง ูู ููู ุงูููุชุฌ ููุฌูุฏุงูุ ูู ุชุธูุฑ ุตูุฑุฉ

### 2. ุฃููุงุน Offers:
- **Catalog Offers**: ูุฌูุจ ุงูุตูุฑุฉ ูู ุฌุฏูู `products`
- **OCR Offers**: ูุฌูุจ ุงูุตูุฑุฉ ูู ุฌุฏูู `ocr_products` (ุฅุฐุง ูุงู ููุฌูุฏุงู)

### 3. ุงูุฃุฏุงุก:
- โ ุงูุตูุฑ ูุชู cache-ูุง ุจูุงุณุทุฉ `CachedNetworkImage`
- โ JOIN ูุชู ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ุฌูุจ ุงูุจูุงูุงุช
- โ ูุง ููุฌุฏ overhead ุฅุถุงูู

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

ุงูุขู ุชุงุจ Offers ูุนุฑุถ:
- โ ุตูุฑ ุงูููุชุฌุงุช ูู ุงูุฌุฏูู
- โ ุฅููุงููุฉ ุงูููุฑ ุนูู ุงูุตูุฑุฉ
- โ ุฏูุงููุฌ ุจุงูุชูุงุตูู ุงููุงููุฉ
- โ ุชุตููู ูุชูุงุณู ูุน ุจุงูู ุงูุชุงุจุงุช
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ

## ๐ ุฅุฐุง ูู ุชุธูุฑ ุงูุตูุฑ:

### ุชุญูู ูู:
1. โ ูุฌูุฏ Foreign Key ุจูู offers ู products
2. โ ุฃู ุงูู product_id ุตุญูุญ ูููุฌูุฏ
3. โ ุฃู ุฌุฏูู products ูุญุชูู ุนูู ุญูู image_url
4. โ ุฃู ุงูุตูุฑ ูุฑููุนุฉ ูURLs ุตุญูุญุฉ

### SQL ููุชุญูู:
```sql
-- ุชุญูู ูู ุงูุนูุงูุฉ
SELECT o.id, o.product_id, p.image_url
FROM offers o
LEFT JOIN products p ON o.product_id = p.id
LIMIT 10;
```
