# ุฏููู ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช - Firebase Notifications

## ๐ ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### 1. Service Account (โ ููุฌูุฏ ุจุงููุนู)

ุงูููู `fieldawy-store-app-66c0ffe5a54f.json` ููุฌูุฏ ุจุงููุนู ูู ุงููุดุฑูุน ููุญุชูู ุนูู ุจูุงูุงุช Service Account.

> โ๏ธ **ุชูุจูู ููู:** ูุง ุชูุดุฑ ูุฐุง ุงูููู ุนูู GitHub ุฃู ุฃู ููุงู ุนุงู!
> 
> ูุญูุงูุฉ ุงููุดุฑูุนุ ุฃุถู ุงูููู ูู `.gitignore`:
> ```
> fieldawy-store-app-*.json
> *.json
> ```

ุฅุฐุง ุงุญุชุฌุช ุฅูุดุงุก Service Account ุฌุฏูุฏ:
1. ุงูุชุญ [Firebase Console](https://console.firebase.google.com/)
2. ุงุฎุชุฑ ูุดุฑูุนู: `fieldawy-store-app`
3. ุงุถุบุท ุนูู โ๏ธ **Project Settings** > **Service accounts**
4. ุงุถุบุท **Generate new private key**
5. ุงุญูุธ ุงูููู ูู ูุฌูุฏ ุงููุดุฑูุน

### 2. ุงูุญุตูู ุนูู FCM Token

1. ุดุบูู ุงูุชุทุจูู ุนูู ุฌูุงุฒ ุญูููู ุฃู ูุญุงูู
2. ุงุจุญุซ ูู console ุนู:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ FCM TOKEN ููุงุฎุชุจุงุฑ:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
[FCM TOKEN ููุง]
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```
3. ุงูุณุฎ ุงูู Token ูุงุณุชุจุฏูู ูู `send_notification.js`

### 3. ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ

ุงูุชุญ terminal ูู ูุฌูุฏ ุงููุดุฑูุน ูุงูุชุจ:

```bash
npm install
```

ูุฐุง ุณูุซุจุช `firebase-admin` ุงูุฐู ูุณุชุฎุฏู Service Account ูููุตุงุฏูุฉ.

## ๐ ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช

### ุงูุทุฑููุฉ ุงูุฃููู - ุจุงุณุชุฎุฏุงู npm scripts:

```bash
# ุฅุดุนุงุฑ ุนุงู
npm run send:general

# ุฅุดุนุงุฑ ุทูุจ ุฌุฏูุฏ
npm run send:order

# ุฅุดุนุงุฑ ุนุฑุถ ุฎุงุต
npm run send:offer
```

### ุงูุทุฑููุฉ ุงูุซุงููุฉ - ูุจุงุดุฑุฉ:

```bash
# ุฅุดุนุงุฑ ุนุงู
node send_notification.js general

# ุฅุดุนุงุฑ ุทูุจ
node send_notification.js order

# ุฅุดุนุงุฑ ุนุฑุถ
node send_notification.js offer
```

## ๐ฑ ุฃููุงุน ุงูุฅุดุนุงุฑุงุช

### 1. ุฅุดุนุงุฑ ุทูุจ ุฌุฏูุฏ (Order)
- **ุงูููู:** ๐ข ุฃุฎุถุฑ
- **ุงูููุงุฉ:** orders_channel
- **ุงูุงุณุชุฎุฏุงู:** ุนูุฏ ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ

### 2. ุฅุดุนุงุฑ ุนุฑุถ ุฎุงุต (Offer)
- **ุงูููู:** ๐ ุจุฑุชูุงูู
- **ุงูููุงุฉ:** offers_channel
- **ุงูุงุณุชุฎุฏุงู:** ููุนุฑูุถ ูุงูุชุฎููุถุงุช

### 3. ุฅุดุนุงุฑ ุนุงู (General)
- **ุงูููู:** ๐ต ุฃุฒุฑู
- **ุงูููุงุฉ:** general_channel
- **ุงูุงุณุชุฎุฏุงู:** ุฅุดุนุงุฑุงุช ุนุงูุฉ ูุฑุณุงุฆู ุฅุฏุงุฑูุฉ

## ๐ง ุชุฎุตูุต ุงูุฅุดุนุงุฑุงุช

ูุฅุถุงูุฉ ููุน ุฌุฏูุฏ ูู ุงูุฅุดุนุงุฑุงุชุ ุนุฏูู ููู `send_notification.js`:

```javascript
const notificationTemplates = {
  // ... ุงูุฃููุงุน ุงูููุฌูุฏุฉ
  
  your_type: {
    notification: {
      title: "ุนููุงู ุงูุฅุดุนุงุฑ",
      body: "ูุญุชูู ุงูุฅุดุนุงุฑ",
      sound: "default",
    },
    data: {
      type: "your_type",
      screen: "target_screen",
      custom_field: "custom_value",
    },
  },
};
```

## ๐งช ุงุฎุชุจุงุฑ ูู Firebase Console

ููููู ุฃูุถุงู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูู Firebase Console ูุจุงุดุฑุฉ:

1. ุงูุชุญ Firebase Console > **Cloud Messaging**
2. ุงุถุบุท **Send your first message**
3. ุงููุฃ ุงูุจูุงูุงุช:
   - **Notification title:** ุนููุงู ุงูุฅุดุนุงุฑ
   - **Notification text:** ุงููุญุชูู
4. ูู **Target**ุ ุงุฎุชุฑ **Single device**
5. ุงูุตู FCM Token
6. ูู **Additional options** > **Custom data**ุ ุฃุถู:
   - Key: `type`, Value: `order` ุฃู `offer` ุฃู `general`
   - Key: `screen`, Value: `orders` ุฃู `offers` ุฃู `home`

## ๐ ูุชุงุฆุฌ ุงูุฅุฑุณุงู

### ูุฌุงุญ ุงูุฅุฑุณุงู:
```json
{
  "multicast_id": 1234567890,
  "success": 1,
  "failure": 0,
  "canonical_ids": 0,
  "results": [
    {
      "message_id": "0:1234567890"
    }
  ]
}
```

### ูุดู ุงูุฅุฑุณุงู:
```json
{
  "multicast_id": 1234567890,
  "success": 0,
  "failure": 1,
  "results": [
    {
      "error": "InvalidRegistration"
    }
  ]
}
```

## โ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: Token ุบูุฑ ุตุญูุญ
**ุงูุญู:** ุชุฃูุฏ ูู ูุณุฎ Token ูุงููุงู ูู console ุงูุชุทุจูู

### ุงููุดููุฉ: Service Account ุบูุฑ ุตุญูุญ
**ุงูุญู:** ุชุฃูุฏ ูู ูุฌูุฏ ููู `fieldawy-store-app-66c0ffe5a54f.json` ูู ููุณ ูุฌูุฏ `send_notification.js`

### ุงููุดููุฉ: ุงูุฅุดุนุงุฑ ูุง ูุธูุฑ
**ุงูุญู:** 
- ุชุฃูุฏ ูู ุชูุนูู ุงูุฅุดุนุงุฑุงุช ุนูู ุงูุฌูุงุฒ
- ุชุญูู ูู ุฃู ุงูุชุทุจูู ููุณ ูู Doze Mode
- ุนูู Android 13+ุ ุชุฃูุฏ ูู ููุญ ุฅุฐู POST_NOTIFICATIONS

### ุงููุดููุฉ: Module not found 'node-fetch'
**ุงูุญู:** ููุฐ `npm install` ูู ูุฌูุฏ ุงููุดุฑูุน

## ๐ ุงูุฃูุงู

- โ๏ธ **ููู ุฌุฏุงู:** ูุง ุชูุดุฑ ููู Service Account ุนูู GitHub ุฃู ุฃู ููุงู ุนุงู
- ๐ ุฃุถู `*.json` ู `fieldawy-store-app-*.json` ูู `.gitignore`
- ๐ก๏ธ ูุฐุง ุงููุดุฑูุน ูุณุชุฎุฏู Firebase Admin SDK v2 (ุฃุญุฏุซ ูุฃูุซุฑ ุฃูุงูุงู ูู Legacy API)

## ๐ ูุตุงุฏุฑ ุฅุถุงููุฉ

- [Firebase Cloud Messaging Documentation](https://firebase.google.com/docs/cloud-messaging)
- [Flutter Local Notifications](https://pub.dev/packages/flutter_local_notifications)
- [Firebase Messaging Flutter](https://pub.dev/packages/firebase_messaging)
